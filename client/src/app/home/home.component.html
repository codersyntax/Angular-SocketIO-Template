<div class="container">
    <div #logIn *ngIf='!CharacterHandler.Character'>
        <input #logInTextField type="text" (keyup.enter)="onNameEnter(logInTextField.value)" />
    </div>
    <div #characterData *ngIf="CharacterHandler.Character">
        <div class="left-container">
            <button class="accordion" (click)="OnSectionClick($event)">Character Data</button>
            <div class="panel">
                <table style="border: 0;">
                    <td style="border: 0; vertical-align: top;">
                        <p>Name: {{CharacterHandler.Character.Name}} <button (click)="ResetCharacter();">Reset Character</button></p>
                        <p>Level: {{CharacterHandler.Character.Level}} \ 
                            Experience: {{CharacterHandler.Character.Experience}}&nbsp;&nbsp;&nbsp;
                            <button (click)="OnDecreaseXPClick()">-</button>
                            <button (click)="OnAddXPClick()">+</button>
                        </p>
                        <p>
                            Currency: {{CharacterHandler.Character.Currency}}&nbsp;&nbsp;&nbsp;
                            <button (click)="CharacterHandler.Character.Currency = CharacterHandler.Character.Currency - 10; UpdateStorage();">-</button>
                            <button (click)="CharacterHandler.Character.Currency = CharacterHandler.Character.Currency + 20; UpdateStorage();">+</button>
                        </p>
                    </td>
                    <td style="border: 0;">
                        <p>Activity Log</p>
                        <textarea style="width: 90%; height: 100px;" #activityLog></textarea>
                    </td>
                </table>
            </div>
            
            <button class="accordion" (click)="OnSectionClick($event)">Inventory</button>
            <div class="panel">
                <table>
                    <thead>
                        <tr>
                            <th>Name</th>
                            <th>Type</th>
                            <th>Description</th>
                            <th>Value</th>
                            <th>IsRawMaterial</th>
                            <th>Count</th>
                        </tr>
                    </thead>
                    <tbody>
                        <tr *ngFor="let inventoryItem of CharacterHandler.Character.Inventory.Items">
                            <td title="{{inventoryItem.Item.Description}}">{{inventoryItem.Item.Name}}</td>
                            <td>{{ItemType[inventoryItem.Item.Type]}}</td>
                            <td>{{inventoryItem.Item.Description}}</td>
                            <td>{{inventoryItem.Item.Value}}</td>
                            <td>{{inventoryItem.Item.IsRawMaterial}}</td>
                            <td>
                                {{inventoryItem.Count}}
                                <button (click)="RemoveItemFromInventory(inventoryItem.Item.Name)">-</button>
                                <button (click)="AddItemToInventory(inventoryItem.Item.Name)">+</button>
                            </td>
                        </tr>
                    </tbody>
                </table>
            </div>
    
            <button class="accordion" (click)="OnSectionClick($event)">Global Chat</button>
            <div class="panel">
                <table style="border: 0;">
                    <td style="border: 0; vertical-align: top;">
                        <p><textarea style="width:90%; height: 100px;" #chatTextArea readonly></textarea></p>
                        <p>Message: <input style="width:90%;" type="text" #messageTextField (keyup.enter)="onChatMessageEnter()" /></p>
                    </td>
                    <td style="border: 0;">
                        <h3>Current Online Players</h3>
                        <div *ngFor="let player of CurrentOnlinePlayers">
                            <p>{{player.Name}}</p>
                        </div>
                    </td>
                </table>
            </div>
    
            <button class="accordion" (click)="OnSectionClick($event)">Character Log/Save Data</button>
            <div class="panel">
                <textarea style="width: 90%; height: 100px;">{{SaveString}}</textarea>
            </div>
        </div>
    
        <div class="right-container">
            <button class="accordion" (click)="OnSectionClick($event)">Gather</button>
            <div class="panel">
                <table>
                    <thead>
                        <tr>
                            <th>Name</th>
                            <th>Type</th>
                            <th>Lvl Req</th>
                            <th>Gather Rate</th>
                            <th>Experience</th>
                        </tr>
                    </thead>
                    <tbody>
                        <tr *ngFor="let item of CharacterHandler.GatherHandler.GatherableItems">
                            <ng-container *ngIf="CharacterHandler.Character.Level >= item.LevelRequirement">
                                <td title="{{item.Description}}">
                                    <button *ngIf="IsBusy" (click)="CancelAction(); IsBusy = false;">Cancel</button><button *ngIf="!IsBusy" (click)="GatherItem(item)">Gather</button>&nbsp;
                                    {{item.Name}}
                                </td>
                                <td>{{ItemType[item.Type]}}</td>
                                <td>{{item.LevelRequirement}}</td>
                                <td>{{item.Rate}} seconds</td>
                                <td>Grants {{item.Experience}}xp</td>
                            </ng-container>
                        </tr>
                    </tbody>
                </table>
            </div>
    
            <button class="accordion" (click)="OnSectionClick($event)">Craft</button>
            <div class="panel">
                <table>
                    <thead>
                        <tr>
                            <th>Name</th>
                            <th>Type</th>
                            <th>Lvl Req</th>
                            <th>Recipe</th>
                            <th>Craft Rate</th>
                            <th>Experience</th>
                        </tr>
                    </thead>
                    <tbody>
                        <tr *ngFor="let item of CharacterHandler.CraftHandler.CraftableItems">
                            <ng-container *ngIf="CharacterHandler.Character.Level >= item.LevelRequirement">
                                <td title="{{item.Description}}">
                                    <button *ngIf="IsBusy" (click)="CancelAction(); IsBusy = false;">Cancel</button><button *ngIf="!IsBusy" (click)="CraftItem(item)">Craft</button>&nbsp;
                                    {{item.Name}}
                                </td>
                                <td>{{ItemType[item.Type]}}</td>
                                <td>{{item.LevelRequirement}}</td>
                                <td>
                                    <p *ngFor="let recipeItem of item.Recipe">
                                        {{recipeItem.Item.Name}} x {{recipeItem.Count}}
                                    </p>
                                </td>
                                <td>{{item.CraftTime}} seconds</td>
                                <td>Grants {{item.Experience}}xp</td>
                            </ng-container>
                        </tr>
                    </tbody>
                </table>
            </div>
        </div>
    </div>
</div>